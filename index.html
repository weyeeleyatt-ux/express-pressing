<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Express Pressing</title>

  <style>
    :root{
      --bg:#ffffff;
      --card:#ffffff;
      --text:#111;
      --muted:#666;
      --line:#e8e8e8;
      --accent:#2d6cff;
      --accent2:#15c16f;
      --danger:#ff4d4d;
      --radius:18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
      background:var(--bg);
      color:var(--text);
      padding:18px;
    }

    .wrap{max-width:820px;margin:0 auto}
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
    }

    .brand{
      display:flex;align-items:center;gap:14px;margin-bottom:14px;
      border-bottom:1px solid var(--line);
      padding-bottom:14px;
    }
    .brand img{
      width:90px;height:auto;
      border-radius:14px;
      object-fit:contain;
      background:#fff;
      border:1px solid var(--line);
      padding:6px;
    }
    .brand h1{margin:0;font-size:28px;letter-spacing:.2px}
    .brand p{margin:6px 0 0;color:var(--muted);font-size:14px}

    .info{
      margin:10px 0 16px;padding:12px;
      border:1px solid var(--line);
      border-radius:14px;background:#fafafa;
      line-height:1.8;font-size:14px;
    }

    .badge{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:#444;
      font-size:12px;
      margin-top:10px;
    }

    label{display:block;margin:12px 0 8px;font-weight:700;font-size:14px}
    input,select,textarea{
      width:100%;padding:13px 12px;border-radius:14px;
      border:1px solid var(--line);background:#fff;color:#111;
      outline:none;font-size:15px;
    }
    input::placeholder, textarea::placeholder{color:#999}
    textarea{min-height:90px;resize:vertical}

    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:650px){.row{grid-template-columns:1fr}.brand h1{font-size:24px}}

    .sectionTitle{
      margin-top:16px;
      padding-top:10px;
      border-top:1px solid var(--line);
      font-weight:900;
    }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      vertical-align:top;
      font-size:14px;
    }
    th{background:#fafafa;text-align:right}
    tr:last-child td{border-bottom:none}

    .qtyInput{
      width:90px;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--line);
    }

    .muted{color:var(--muted);font-size:12px;line-height:1.6}

    .priceBox{
      margin-top:14px;padding:12px;border-radius:14px;
      border:1px solid var(--line);background:#fafafa;
      display:grid;gap:6px;font-size:14px;
    }
    .priceBox b{font-size:16px}

    .btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{
      border:none;border-radius:16px;
      padding:14px 14px;
      font-size:16px;font-weight:800;
      cursor:pointer;
    }
    .btnWide{flex:1;min-width:220px}
    .btnPrimary{background:var(--accent);color:#fff}
    .btnGreen{background:var(--accent2);color:#001b0d}
    .btnGhost{background:#fff;border:1px solid var(--line);color:#111}

    .codeBox{
      margin-top:12px;padding:12px;border-radius:14px;
      border:1px dashed #cfcfcf;background:#fff;
      display:none;justify-content:space-between;align-items:center;gap:10px;
    }
    .code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:18px;font-weight:900;letter-spacing:1px;
    }

    .warn{
      color:#7a1d1d;
      background:rgba(255,77,77,.10);
      border:1px solid rgba(255,77,77,.25);
      padding:10px 12px;border-radius:14px;
      margin-top:12px;display:none;
    }

    .footerNote{text-align:center;color:#777;font-size:12px;margin-top:14px}

    /* ====== Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ====== */
    @media print{
      body{padding:0;background:#fff}
      .noPrint{display:none !important}
      .card{box-shadow:none;border:none}
      .info{background:#fff}
      table{border:1px solid #ccc}
      th{background:#f3f3f3}
    }
  </style>
</head>

<body>
<div class="wrap">
  <div class="card" id="printArea">

    <div class="brand">
      <img src="logo.PNG" alt="Express Pressing Logo">
      <div>
        <h1>Express Pressing</h1>
        <p>~ Fresh â€¢ Fast â€¢ Clean ~</p>
      </div>
    </div>

    <div class="info">
      ğŸ“ Ù„ÙƒØµØ± - Ù†ÙˆØ§ÙƒØ´ÙˆØ·<br>
      ğŸšš ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ<br>
      â˜ï¸ 33371707<br>
      ğŸ’³ Ø§Ù„Ø¯ÙØ¹: Ø¨Ù†ÙƒÙŠÙ„ÙŠ / Ù…ØµØ±ÙÙŠ / Ø³Ø¯Ø§Ø¯<br>
      ğŸ§¾ Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹: 33371707
      <div class="badge noPrint">Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹: Ø§Ø±ÙØ¹ Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª ÙˆØ³ÙŠØ·Ù„Ø¹ Ù„Ùƒ ÙƒÙˆØ¯ + ØªÙ‚Ø¯Ø± ØªØ·Ø¨Ø¹ ÙØ§ØªÙˆØ±Ø©</div>
    </div>

    <div class="row noPrint">
      <div>
        <label>Ø§Ù„Ø§Ø³Ù…</label>
        <input id="name" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ" />
      </div>
      <div>
        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
        <input id="phone" inputmode="numeric" placeholder="Ù…Ø«Ø§Ù„: 33371707" />
      </div>
    </div>

    <div class="row noPrint">
      <div>
        <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
        <textarea id="address" placeholder="Ø§Ù„Ø­ÙŠ - Ø§Ù„Ø´Ø§Ø±Ø¹ - Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø©"></textarea>
      </div>
      <div>
        <label>ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <textarea id="details" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù„Ø§Ø¨Ø³ Ø¨ÙŠØ¶Ø§Ø¡ØŒ Ø­Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø§Ù„Ø¹Ø·Ø±..."></textarea>
      </div>
    </div>

    <div class="noPrint">
      <label>Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª Ø§Ù„Ø¯ÙØ¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input id="payShot" type="file" accept="image/*" />
      <div class="muted">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ø§ ÙŠØ±Ø³Ù„ Ø§Ù„ØµÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„ÙˆØ§ØªØ³Ø§Ø¨. Ø¨Ø¹Ø¯ ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ø±ÙÙ‚ Ø§Ù„Ø³ÙÙƒØ±ÙŠÙ†Ø´ÙˆØª ÙŠØ¯ÙˆÙŠÙ‹Ø§.</div>
    </div>

    <div class="sectionTitle">Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± (Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ù„ÙƒÙ„ Ø®Ø¯Ù…Ø©)</div>

    <table class="noPrint">
      <thead>
        <tr>
          <th style="width:40%;">Ø§Ù„Ø®Ø¯Ù…Ø©</th>
          <th>Ø§Ù„ÙˆØµÙ</th>
          <th style="width:110px;">Ø§Ù„Ø³Ø¹Ø±</th>
          <th style="width:120px;">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
        </tr>
      </thead>
      <tbody id="servicesBody"></tbody>
    </table>

    <div class="priceBox">
      <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <b id="grandTotal">0</b> MRO</div>
      <div class="muted">* Ø§Ù„Ø³Ø¹Ø± Ù…Ø­Ø³ÙˆØ¨ = (Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ã— Ø§Ù„ÙƒÙ…ÙŠØ©)</div>
    </div>

    <div class="warn noPrint" id="warnBox"></div>

    <div class="btnRow noPrint">
      <button class="btn btnGreen btnWide" id="genCodeBtn">âœ… Ø·Ù„Ù‘Ø¹ ÙƒÙˆØ¯ (20 - 2000)</button>
      <button class="btn btnGhost btnWide" id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© ÙØ§ØªÙˆØ±Ø©</button>
      <button class="btn btnPrimary btnWide" id="waBtn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>

    <div class="codeBox noPrint" id="codeBox">
      <div>
        <div style="color:#777;font-size:12px;">ÙƒÙˆØ¯ Ø§Ù„Ø·Ù„Ø¨</div>
        <div class="code" id="orderCode">â€”</div>
      </div>
      <button class="btn btnGhost" style="width:auto;margin:0;padding:10px 12px;" id="copyBtn">Ù†Ø³Ø®</button>
    </div>

    <!-- Ù†Ø³Ø®Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© (ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©) -->
    <div class="sectionTitle" style="margin-top:18px;">Ø§Ù„ÙØ§ØªÙˆØ±Ø©</div>

    <table>
      <thead>
        <tr>
          <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
          <th>Ø§Ù„Ø³Ø¹Ø±</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
        </tr>
      </thead>
      <tbody id="invoiceBody">
        <tr><td colspan="4" class="muted">Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø§Øª/ÙƒÙ…ÙŠØ§Øª Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ (Ø«Ù… Ø§Ø·Ø¨Ø¹).</td></tr>
      </tbody>
      <tfoot>
        <tr>
          <th colspan="3">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
          <th><span id="invoiceTotal">0</span> MRO</th>
        </tr>
      </tfoot>
    </table>

    <div class="footerNote">Â© Express Pressing</div>
  </div>
</div>

<script>
  // ====== Ø¥Ø¹Ø¯Ø§Ø¯ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ (Ø¨Ø¯Ù‘Ù„ Ø§Ù„Ø±Ù‚Ù… Ø¥Ø°Ø§ Ø¨Ø¯Ùƒ) ======
  // Ø±Ù‚Ù… Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§ Ø¨ØµÙŠØºØ© Ø¯ÙˆÙ„ÙŠØ© Ø¨Ø¯ÙˆÙ† +
  const WHATSAPP_NUMBER = "22233371707";

  // ====== Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª (ØªÙ‚Ø¯Ø± ØªØ¹Ø¯Ù‘Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±/Ø§Ù„Ù†Øµ Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù‡Ù†Ø§) ======
  // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø·Ù„Ø¨ MRO
  const SERVICES = [
    // (Ø§Ù„Ù„ÙŠ Ø·Ù„Ø¨ØªÙ‡Ù… Ø§Ù†Øª)
    {name:"ØºØ³ÙŠÙ„ Ù…Ù„Ø§Ø­Ù ÙƒØ§Ø²", desc:"Ù„Ù„Ù‚Ø·Ø¹Ø© â€” ØºØ³ÙŠÙ„ Ù…Ù„Ø§Ø­Ù ÙƒØ§Ø² Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©", price:250},
    {name:"ØºØ³ÙŠÙ„ Ù…Ù„Ø§Ø­Ù ØºÙŠØ± ÙƒØ§Ø²", desc:"Ù„Ù„Ù‚Ø·Ø¹Ø© â€” ØºØ³ÙŠÙ„ Ù…Ù„Ø§Ø­Ù ØºÙŠØ± ÙƒØ§Ø² Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©", price:300},
    {name:"ØºØ³ÙŠÙ„ Ø¯Ø±Ø§Ø¹Ø©", desc:"Ù„Ù„Ù‚Ø·Ø¹Ø© â€” ØºØ³ÙŠÙ„ ÙˆØªÙ†Ø¸ÙŠÙ Ø¯Ø±Ø§Ø±ÙŠØ¹ Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©", price:600},
    {name:"ØºØ³ÙŠÙ„ Ù…Ù„Ø§Ø¨Ø³", desc:"Ù„Ù„Ù‚Ø·Ø¹Ø© â€” ØºØ³ÙŠÙ„ Ø¹Ø§Ø¯ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù„Ø§Ø¨Ø³", price:100},
    {name:"ØºØ³ÙŠÙ„ Ø¨Ø¯Ù„Ø©", desc:"Ù„Ù„Ù‚Ø·Ø¹Ø© â€” ØªÙ†Ø¸ÙŠÙ Ø¬Ø§Ù Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„Ø¨Ø¯Ù„ Ø§Ù„Ø±Ø³Ù…ÙŠØ©", price:400},

    // (Ø¥Ø¶Ø§ÙØ§Øª Ù…Ù† Ø§Ù„ÙØ§ØªÙˆØ±Ø©/Ø§Ù„ØµÙˆØ±Ø© â€” Ø¥Ø°Ø§ Ø¨Ø¯Ùƒ Ø§Ø­Ø°Ù Ø§Ù„Ù„ÙŠ Ù…Ø§ ØªØ±ÙŠØ¯Ù‡)
    {name:"Ø¨Ø¯Ù„Ø© (ÙØ§ØªÙˆØ±Ø©)", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:1300},
    {name:"ÙØ³Øª", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:700},
    {name:"Ø¨Ù†Ø·Ù„ÙˆÙ†", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:200},
    {name:"Ù‚Ù…ÙŠØµ", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:200},
    {name:"ØªÙÙŠØ´ÙŠØ±Øª / ØªØ´Ø±Øª", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:100},
    {name:"Ø³Ø±ÙˆØ§Ù„", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:200},
    {name:"ÙƒÙˆÙØ±Ù„ÙŠ", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:700},
    {name:"Ù…Ù„Ø­ÙØ© ÙƒØ§Ø² (ÙØ§ØªÙˆØ±Ø©)", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:200},
    {name:"Ù…Ù„Ø­ÙØ© (ÙØ§ØªÙˆØ±Ø©)", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:250},
    {name:"Ø¯Ø±Ø§Ø¹Ø© Ø¨Ø§Ø²Ø§ (ÙØ§ØªÙˆØ±Ø©)", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:500},
    {name:"Ø¬Ù„Ø§Ø¨ÙŠØ©", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:300},
    {name:"Ø¬Ø§ÙƒÙŠØª", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:300},
    {name:"Ø±Ø¨Ø§Ø¨Ø©", desc:"Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©", price:100}
  ];

  const servicesBody = document.getElementById("servicesBody");
  const invoiceBody  = document.getElementById("invoiceBody");
  const grandTotalEl = document.getElementById("grandTotal");
  const invoiceTotalEl = document.getElementById("invoiceTotal");

  const nameEl = document.getElementById("name");
  const phoneEl = document.getElementById("phone");
  const addressEl = document.getElementById("address");
  const detailsEl = document.getElementById("details");
  const payShotEl = document.getElementById("payShot");

  const warnBox = document.getElementById("warnBox");
  const genCodeBtn = document.getElementById("genCodeBtn");
  const codeBox = document.getElementById("codeBox");
  const orderCodeEl = document.getElementById("orderCode");
  const copyBtn = document.getElementById("copyBtn");
  const waBtn = document.getElementById("waBtn");
  const printBtn = document.getElementById("printBtn");

  let ORDER_CODE = "";

  function showWarn(msg){
    warnBox.style.display = "block";
    warnBox.textContent = msg;
    setTimeout(()=>{ warnBox.style.display = "none"; }, 3500);
  }

  function hasPaymentProof(){
    return (payShotEl.files && payShotEl.files.length > 0);
  }

  function makeCode20to2000(){
    // Ø±Ù‚Ù… Ù…Ù† 20 Ø¥Ù„Ù‰ 2000
    const n = Math.floor(Math.random() * (2000 - 20 + 1)) + 20;
    return "XP-" + n;
  }

  function renderServices(){
    servicesBody.innerHTML = "";
    SERVICES.forEach((s, i)=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><b>${s.name}</b></td>
        <td class="muted">${s.desc}</td>
        <td><b>${s.price}</b> MRO</td>
        <td>
          <input class="qtyInput" type="number" min="0" max="100" value="0" data-idx="${i}">
        </td>
      `;
      servicesBody.appendChild(tr);
    });

    servicesBody.querySelectorAll('input.qtyInput').forEach(inp=>{
      inp.addEventListener("input", calcAll);
    });
  }

  function getSelectedItems(){
    const items = [];
    servicesBody.querySelectorAll('input.qtyInput').forEach(inp=>{
      const idx = parseInt(inp.getAttribute("data-idx"), 10);
      let qty = parseInt(inp.value || "0", 10);
      if(isNaN(qty)) qty = 0;
      if(qty < 0) qty = 0;
      if(qty > 100) qty = 100;
      inp.value = qty;

      if(qty > 0){
        const s = SERVICES[idx];
        items.push({
          name: s.name,
          price: s.price,
          qty,
          sub: s.price * qty
        });
      }
    });
    return items;
  }

  function calcAll(){
    const items = getSelectedItems();
    const total = items.reduce((a,b)=>a+b.sub, 0);
    grandTotalEl.textContent = total;
    invoiceTotalEl.textContent = total;

    if(items.length === 0){
      invoiceBody.innerHTML = `<tr><td colspan="4" class="muted">Ù…Ø§ Ø§Ø®ØªØ±Øª Ø£ÙŠ Ø®Ø¯Ù…Ø© Ø¨Ø¹Ø¯.</td></tr>`;
      return;
    }

    invoiceBody.innerHTML = items.map(it=>`
      <tr>
        <td>${it.name}</td>
        <td>${it.price} MRO</td>
        <td>${it.qty}</td>
        <td><b>${it.sub}</b> MRO</td>
      </tr>
    `).join("");
  }

  genCodeBtn.addEventListener("click", (e)=>{
    e.preventDefault();
    // Ø¥Ø°Ø§ Ø¨Ø¯Ùƒ ØªØ¬Ø¹Ù„ Ø§Ù„Ø³ÙÙƒØ±ÙŠÙ†Ø´ÙˆØª "Ø¥Ø¬Ø¨Ø§Ø±ÙŠ" Ù‚Ø¨Ù„ Ø§Ù„ÙƒÙˆØ¯ØŒ ÙÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚:
    // if(!hasPaymentProof()){ showWarn("Ù„Ø§Ø²Ù… ØªØ±ÙØ¹ Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª Ø§Ù„Ø¯ÙØ¹ Ø£ÙˆÙ„Ø§Ù‹"); return; }

    if(!ORDER_CODE) ORDER_CODE = makeCode20to2000();
    orderCodeEl.textContent = ORDER_CODE;
    codeBox.style.display = "flex";
    showWarn("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ¯ âœ…");
  });

  copyBtn.addEventListener("click", async ()=>{
    try{
      await navigator.clipboard.writeText(orderCodeEl.textContent);
      showWarn("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
    }catch{
      showWarn("Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¯ÙˆÙŠÙ‹Ø§");
    }
  });

  printBtn.addEventListener("click", ()=>{
    const items = getSelectedItems();
    if(items.length === 0){ showWarn("Ø§Ø®ØªÙØ± Ø®Ø¯Ù…Ø§Øª/ÙƒÙ…ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©"); return; }
    window.print();
  });

  waBtn.addEventListener("click", ()=>{
    const name = (nameEl.value || "").trim();
    const phone = (phoneEl.value || "").trim();
    const address = (addressEl.value || "").trim();
    const details = (detailsEl.value || "").trim();

    const items = getSelectedItems();
    const total = parseInt(grandTotalEl.textContent || "0", 10);

    if(!name || !phone || !address){
      showWarn("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… + Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ + Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£ÙˆÙ„Ø§Ù‹");
      return;
    }
    if(items.length === 0){
      showWarn("Ø§Ø®ØªÙØ± Ø®Ø¯Ù…Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (ÙƒÙ…ÙŠØ© > 0)");
      return;
    }

    if(!ORDER_CODE){
      ORDER_CODE = makeCode20to2000();
      orderCodeEl.textContent = ORDER_CODE;
      codeBox.style.display = "flex";
    }

    const payNote = hasPaymentProof()
      ? "âœ… ØªÙ… Ø±ÙØ¹ Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª Ø§Ù„Ø¯ÙØ¹ (Ø§Ø±Ø³Ù„Ù‡Ø§ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨)"
      : "âš ï¸ Ù„Ù… ÙŠØªÙ… Ø±ÙØ¹ Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª (Ø§Ø±Ø³Ù„Ù‡Ø§ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹)";

    const lines = items.map(it=>`- ${it.name} | ${it.qty} Ã— ${it.price} = ${it.sub} MRO`).join("\n");

    const msg =
`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Express Pressing
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
Ø§Ù„Ø§Ø³Ù…: ${name}
Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${phone}
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}
ØªÙØ§ØµÙŠÙ„: ${details || "â€”"}
Ø§Ù„Ø®Ø¯Ù…Ø§Øª:
${lines}
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} MRO
Ø§Ù„Ø¯ÙØ¹: ${payNote}
ÙƒÙˆØ¯ Ø§Ù„Ø·Ù„Ø¨: ${ORDER_CODE}
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
(Ø¨Ø¹Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŒ Ø£Ø±ÙÙ‚ Ø³ÙƒØ±ÙŠÙ†Ø´ÙˆØª Ø§Ù„Ø¯ÙØ¹ Ù‡Ù†Ø§ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨)`;

    const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
    window.open(url, "_blank");
  });

  // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
  renderServices();
  calcAll();
</script>

</body>
</html>
